<!DOCTYPE HTML>
<html lang="en" class="light" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Systems Programming</title>
        <meta name="robots" content="noindex">


        <!-- Custom HTML head -->
        
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="favicon.svg">
        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        <link rel="stylesheet" href="./mdbook-admonish.css">
        <link rel="stylesheet" href="./css/mdbook-admonish.css">

    </head>
    <body class="sidebar-visible no-js">
    <div id="body-container">
        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('light')
            html.classList.add(theme);
            var body = document.querySelector('body');
            body.classList.remove('no-js')
            body.classList.add('js');
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var body = document.querySelector('body');
            var sidebar = null;
            var sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            sidebar_toggle.checked = sidebar === 'visible';
            body.classList.remove('sidebar-visible');
            body.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded "><a href="week1.html"><strong aria-hidden="true">1.</strong> Operating Systems</a></li><li class="chapter-item expanded "><a href="week2.html"><strong aria-hidden="true">2.</strong> Processes</a></li><li class="chapter-item expanded "><a href="week3.html"><strong aria-hidden="true">3.</strong> Threads & Process Synchronization</a></li><li class="chapter-item expanded "><a href="week4.html"><strong aria-hidden="true">4.</strong> CPU Scheduling & Deadlocks</a></li><li class="chapter-item expanded "><a href="week5.html"><strong aria-hidden="true">5.</strong> Week 5</a></li><li class="chapter-item expanded "><a href="week6.html"><strong aria-hidden="true">6.</strong> Week 6</a></li><li class="chapter-item expanded "><a href="week9.html"><strong aria-hidden="true">7.</strong> Networking - Models & Layers</a></li><li class="chapter-item expanded "><a href="week12.html"><strong aria-hidden="true">8.</strong> Security</a></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <!-- Track and set sidebar scroll position -->
        <script>
            var sidebarScrollbox = document.querySelector('#sidebar .sidebar-scrollbox');
            sidebarScrollbox.addEventListener('click', function(e) {
                if (e.target.tagName === 'A') {
                    sessionStorage.setItem('sidebar-scroll', sidebarScrollbox.scrollTop);
                }
            }, { passive: true });
            var sidebarScrollTop = sessionStorage.getItem('sidebar-scroll');
            sessionStorage.removeItem('sidebar-scroll');
            if (sidebarScrollTop) {
                // preserve sidebar scroll position when navigating via links within sidebar
                sidebarScrollbox.scrollTop = sidebarScrollTop;
            } else {
                // scroll sidebar to current active section when navigating via "next/previous chapter" buttons
                var activeSection = document.querySelector('#sidebar .active');
                if (activeSection) {
                    activeSection.scrollIntoView({ block: 'center' });
                }
            }
        </script>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">Systems Programming</h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="what-is-an-operating-system"><a class="header" href="#what-is-an-operating-system">What is an Operating System</a></h1>
<ul>
<li>Software that controls hardware to perform various operations.</li>
<li>Can be a collection of software.</li>
<li>Can be simple or complex.</li>
</ul>
<p>Modern OS's contain several complex functions:</p>
<ul>
<li>Manage processes.</li>
<li>Manage memory.</li>
<li>Interact with hardware.</li>
<li>Manage multiple concurrently running software.</li>
</ul>
<h1 id="os-modes"><a class="header" href="#os-modes">OS "Modes"</a></h1>
<p>OS software can run in different modes:</p>
<ul>
<li>User mode - Apps and the UI run in this mode. Applications must request the
OS to perform hardware actions on their behalf.</li>
<li>Kernel mode - The OS runs in this mode. Also called "Supervisor Mode". Code
that runs in kernel mode has direct access to hardware allowing it to perform
any operations on the hardware.</li>
</ul>
<h1 id="some-functions-of-the-os"><a class="header" href="#some-functions-of-the-os">Some Functions of the OS</a></h1>
<ul>
<li>Read/Write Disk/Memory.</li>
<li>Pure computations.</li>
<li>Network communication.</li>
<li>Media playback.</li>
<li>I/O peripheral communication.</li>
<li>General OS security.</li>
</ul>
<h1 id="the-os-manages-resources"><a class="header" href="#the-os-manages-resources">The OS Manages Resources</a></h1>
<ul>
<li>Hardware.</li>
<li>Software.</li>
<li>The file system.</li>
<li>In memory data.</li>
</ul>
<p>Modern OS's are capable of managing multitasking and multiprocessing resources.</p>
<h1 id="common-os-hardware"><a class="header" href="#common-os-hardware">Common OS Hardware</a></h1>
<h2 id="cpu"><a class="header" href="#cpu">CPU</a></h2>
<blockquote>
<p>The brain of the computer</p>
</blockquote>
<p>Fetches instructions and data from memory to execute and operate on them. CPU
family specific instructions exist.</p>
<h2 id="memory"><a class="header" href="#memory">Memory</a></h2>
<p>General storage for the computer. Ranges from fast to quick:</p>
<ul>
<li>Hardware registers.</li>
<li>CPU local cache.</li>
<li>Main Memory (RAM).</li>
<li>SSD's.</li>
<li>HDD's.</li>
<li>Optical disks.</li>
<li>Magnetic tapes.</li>
</ul>
<h2 id="io-devices"><a class="header" href="#io-devices">I/O Devices</a></h2>
<ul>
<li>Monitors.</li>
<li>Keyboards+</li>
<li>Mice.</li>
<li>USB flash drives.</li>
<li>etc.</li>
</ul>
<h1 id="the-layers-of-an-os"><a class="header" href="#the-layers-of-an-os">The Layers of an OS</a></h1>
<ol>
<li>[App] User and other system programs.</li>
<li>[OS] The UI.</li>
<li>[OS] System calls - How apps interact with the hardware.</li>
<li>[OS] OS services - Ongoing OS processes, such as, I/O operations.</li>
<li>Hardware.</li>
</ol>
<hr />
<h1 id="os-architectures"><a class="header" href="#os-architectures">OS Architectures</a></h1>
<p>OS's are, generally, very large programs. Here are a few ways they are
structured:</p>
<h2 id="the-simple-structure"><a class="header" href="#the-simple-structure">The Simple Structure</a></h2>
<ul>
<li>Not divided into modules</li>
<li>Interfaces and levels of functionality are not well separated.</li>
</ul>
<h2 id="the-layered-structure"><a class="header" href="#the-layered-structure">The Layered Structure</a></h2>
<ul>
<li>Divided into a number of layers. Each is built ontop of the last.</li>
<li>Hardware is layer 0.</li>
<li>The user interface is the highest layer.</li>
<li>Layers are defined such that each only uses the functions services of the
next lower layer.</li>
</ul>
<h2 id="microkernels"><a class="header" href="#microkernels">Microkernels</a></h2>
<ul>
<li>Moves as many services from the kernel into user space.</li>
<li>Communication between user modules typically uses message passing.</li>
<li>Easy to extend.</li>
<li>Easy to port.</li>
<li>Often more reliable.</li>
<li>Often more secure.</li>
<li>There is performance overhead when the various user space modules communicate
with their kernel space dependencies.</li>
</ul>
<h2 id="modules"><a class="header" href="#modules">Modules</a></h2>
<p>Many OS's implement loadable kernel modules.</p>
<ul>
<li>Typically uses an Object-Oriented approach.</li>
<li>Core components are separate.</li>
<li>Modules communicate over known interfaces.</li>
<li>Loaded as needed.</li>
<li>Similar to layers, but more flexible.</li>
</ul>
<h2 id="a-hybrid-approach"><a class="header" href="#a-hybrid-approach">A Hybrid Approach</a></h2>
<p>Most modern OS's use a hybrid approach to address various concerns, such as,
security, preformance, usability, etc.</p>
<h1 id="linux-kernel-modules"><a class="header" href="#linux-kernel-modules">Linux Kernel Modules</a></h1>
<p>Each kernel module usually has an initializing function specified with the
<code>module_init()</code> function (macro?). Similarly there is a deinitializing function
specified with the <code>module_exit()</code> function.
Here is a simple kernel module:</p>
<pre><code class="language-c">#include &lt;linux/init.h&gt;
#include &lt;linux/module.h&gt;
#include &lt;linux/kernel.h&gt;

MODULE_LICENSE("GPL"); // Needed.

static int __init init_kernel_mod(void) {
    printk(KERN_ALERT "Initializing kernel mod!\n");
    return 0;
}

static void __exit exit_kernel_mod(void) {
    printk(KERN_ALERT "Releasing kernel mod resources!\n");
}

module_init(init_kernel_mod);
module_exit(exit_kernel_mod);
</code></pre>
<p>And the associated Makefile:</p>
<pre><code class="language-makefile">CONFIG_MODULE_SIG=n
obj-m += my_kernel_mod.o

default:
	make -C /lib/modules/$(shell uname -r)/build M=$(PWD) modules

clean:
	make -C /lib/modules/$(shell uname -r)/build M=$(PWD) clean
</code></pre>
<p>Review the Linux kernel module development documentation for details.</p>
<h2 id="relevant-cli-commands"><a class="header" href="#relevant-cli-commands">Relevant CLI Commands</a></h2>
<ul>
<li><code>lsmod</code> - List currently loaded mods.</li>
<li><code>modinfo &lt;mod-name&gt;</code> - Prints info about a specific kernel module.</li>
<li><code>rmmod &lt;mod-name&gt;</code> - Removes a currently loaded module.</li>
<li><code>insmod &lt;mod-name&gt;</code> - Loads a new module (no dependencies on unloaded modules
allowed).</li>
<li><code>modprobe &lt;mod-name&gt;</code> - Loads a new module and its dependencies.</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="processes"><a class="header" href="#processes">Processes</a></h1>
<ul>
<li>A program in execution.</li>
<li>Contains program code. (Stored in the "text" section within a binary.)</li>
<li>Data section containing global variables. (This is a feature of the binary format, no?)</li>
<li>Has its own program counter and set of registers.</li>
<li>Has its own stack.</li>
<li>Has associated heap memory.</li>
</ul>
<p>A program is a passive entity stored on disk. When it is loaded into memory
and executed, it becomes an active entity called a Process. A program on disk
can become multiple processes in memory.</p>
<div class="table-wrapper"><table><thead><tr><th style="text-align: center">Process</th></tr></thead><tbody>
<tr><td style="text-align: center">Stack</td></tr>
<tr><td style="text-align: center">.....</td></tr>
<tr><td style="text-align: center">Heap</td></tr>
<tr><td style="text-align: center">Data</td></tr>
<tr><td style="text-align: center">Text</td></tr>
</tbody></table>
</div>
<p>The Stack grows downwards and the Heap grows Upwards.</p>
<h1 id="process-states"><a class="header" href="#process-states">Process States</a></h1>
<ul>
<li><strong>new</strong> - The process is being created.</li>
<li><strong>running</strong> - Instructions are being executed.</li>
<li><strong>waiting</strong> - Execution is paused waiting for some event to occur.</li>
<li><strong>ready</strong> - The process is specifically waiting to be assigned CPU time.</li>
<li><strong>terminated</strong> - The process has finished execution.</li>
</ul>
<pre class="mermaid">---
title: Process States
---
stateDiagram-v2
direction LR
[*] --&gt; New
New --&gt; Ready: admitted
Ready --&gt; Running: scheduler dispatch
Running --&gt; Ready: interrupt
Running --&gt; Waiting: I/O or event wait
Waiting --&gt; Ready: I/O or event completion
Running --&gt; Terminated: exit
Terminated --&gt; [*]
</pre>
<h1 id="process-scheduling"><a class="header" href="#process-scheduling">Process Scheduling</a></h1>
<ul>
<li>It is considered bad to have process wait for a long time before they get
assigned some CPU time.</li>
<li>Effective process management translates to a "performant" computer.</li>
<li>We want to maximize CPU usage, quickly swapping in processes as others
finish or their allocated time slice expires.</li>
</ul>
<h1 id="process-scheduler"><a class="header" href="#process-scheduler">Process Scheduler</a></h1>
<ul>
<li>Selects which process executes next on the CPU.</li>
<li>Maintains a queue of processes.</li>
<li>Various queues:
<ul>
<li><strong>Job Queue</strong> - All processes.</li>
<li><strong>Ready Queue</strong> - All processes in Main Memory in the ready state.</li>
<li><strong>Device Queues</strong> - Processes waiting for an I/O device.</li>
</ul>
</li>
</ul>
<p>With a single CPU core, process must wait for their turn as only one process
can run at a time. There are various <strong>Scheduling Argorithms</strong> to determine
when and which process runs.</p>
<h1 id="two-different-schedulers"><a class="header" href="#two-different-schedulers">Two Different Schedulers</a></h1>
<h2 id="the-short-term-scheduler-aka-cpu-scheduler"><a class="header" href="#the-short-term-scheduler-aka-cpu-scheduler">The Short-Term Scheduler (a.k.a. CPU Scheduler)</a></h2>
<p>Selects which process should next be allocated some CPU time. This is sometimes
the only scheduler in the system. Invoked frequently so it should be fast.</p>
<h2 id="the-long-term-scheduler-aka-job-scheduler"><a class="header" href="#the-long-term-scheduler-aka-job-scheduler">The Long-Term Scheduler (a.k.a. Job Scheduler)</a></h2>
<p>Selects which processes should be brought into the <em>ready queue</em>. Invoked
relatively infrequently, need not be fast.</p>
<h1 id="process-creation"><a class="header" href="#process-creation">Process Creation</a></h1>
<p>Processes are identified by a <code>process identifier</code> (pid). The parent and child
can execute concurrently or the parent can wait for the child to terminate
before continuing to execute.</p>
<p>Parent and child processes have options when it comes to sharing resources:</p>
<ul>
<li>Parent and children can share all resources.</li>
<li>Children share only a subset of resources.</li>
<li>Parent and children share no resources.</li>
</ul>
<p>In terms of the address space:</p>
<ul>
<li>The child can recieve a duplicate of the parent's.</li>
<li>The child can have a fresh program loaded into it. (<code>exec()</code>)</li>
</ul>
<pre class="mermaid">---
title: Process Creation
---
stateDiagram-v2
direction LR
[*] --&gt; fork()
fork() --&gt; exec(): child
exec() --&gt; exit()
exit() --&gt; wait
fork() --&gt; wait: parent
wait --&gt; [*]: resumes
</pre>
<h1 id="process-termination"><a class="header" href="#process-termination">Process Termination</a></h1>
<ul>
<li>Process resources are deallocated by the OS.</li>
<li>A parent may terminate a child process by using the <code>abort()</code> syscall.</li>
<li>Some OS's may not allow children processes to exist if their parent
terminates.</li>
<li>A <strong>zombie process</strong> is a process who's parent is not waiting for its
termination.</li>
<li>An <strong>orphan process</strong> is a process who's parent has terminated.</li>
</ul>
<h1 id="inter-process-communication---ipc"><a class="header" href="#inter-process-communication---ipc">Inter-Process Communication - IPC</a></h1>
<p>Process may be independent or cooperative. If they are cooperative they need
some form of communication. This is what IPC is about. We look at two types
of IPC:</p>
<h2 id="shared-memory"><a class="header" href="#shared-memory">Shared Memory</a></h2>
<ul>
<li>An area of memory shared among processes.</li>
<li>Communication is under control of the user processes.</li>
<li>Requires manual synchronization of communication.</li>
</ul>
<div class="table-wrapper"><table><thead><tr><th style="text-align: center">Shared Memory</th></tr></thead><tbody>
<tr><td style="text-align: center">Process A</td></tr>
<tr><td style="text-align: center"><em>shared memory</em></td></tr>
<tr><td style="text-align: center">Process B</td></tr>
<tr><td style="text-align: center">.....</td></tr>
<tr><td style="text-align: center">.....</td></tr>
</tbody></table>
</div>
<h2 id="message-passing"><a class="header" href="#message-passing">Message Passing</a></h2>
<p>A system for processes to communicate and synchronize their actions. There are
two main operations in message passing: <strong>send</strong> and <strong>recieve</strong>. Message sizes
can be fixed or variable. If two processes wish to communicate, they must
establish a communication link between them. There are physical and logical
concerns for communication link implementations, here are some:</p>
<ul>
<li>Physical - specifically, the medium over which message passing occurs.
<ul>
<li>Shared Memory</li>
<li>A Hardware Bus</li>
<li>The Network</li>
</ul>
</li>
<li>Logical - We look at these in more detail.
<ul>
<li>Direct or indirect.</li>
<li>Synchronous or asynchronous.</li>
<li>automatic or explicit buffering.</li>
</ul>
</li>
</ul>
<div class="table-wrapper"><table><thead><tr><th style="text-align: center">Message Passing</th></tr></thead><tbody>
<tr><td style="text-align: center">Process A</td></tr>
<tr><td style="text-align: center">Process B</td></tr>
<tr><td style="text-align: center">.....</td></tr>
<tr><td style="text-align: center">.....</td></tr>
<tr><td style="text-align: center">Message Queue</br>m1, m2, m3, ...</td></tr>
</tbody></table>
</div>
<h3 id="direct-communication"><a class="header" href="#direct-communication">Direct Communication</a></h3>
<ul>
<li>Processes must name each other directly when sending and receiving.</li>
<li>"Links" are established automatically.</li>
<li>Links are between exactly one pair of processes and there is only one link
between a pair.</li>
<li>May be unidirectional but are usually bi-directional.</li>
</ul>
<h3 id="indirect-communication"><a class="header" href="#indirect-communication">Indirect Communication</a></h3>
<ul>
<li>Messages are sent to and received from mailboxes (or ports.)</li>
<li>Each port has a unique id.</li>
<li>Processes must share this port.</li>
<li>A port or mailbox may be associated with multiple processes.</li>
<li>unidirectional or bi-directional.</li>
</ul>
<h3 id="synchronous-or-asynchronous"><a class="header" href="#synchronous-or-asynchronous">Synchronous or Asynchronous</a></h3>
<ul>
<li>Message passing may be blocking or non-blocking.</li>
</ul>
<h3 id="automatic-or-explicit-buffering"><a class="header" href="#automatic-or-explicit-buffering">Automatic or Explicit Buffering</a></h3>
<p>Each link has a queue of messages with differing capacities and behaviours:</p>
<ul>
<li>Zero capacity - No buffering, the sender must wait for the receiver to
receive.</li>
<li>Bounded Capacity - Finite buffering, the sender must wait if the queue is
full.</li>
<li>Unbounded Capacity - Infinite buffering, the sender never waits.</li>
</ul>
<h2 id="relevant-functions"><a class="header" href="#relevant-functions">Relevant Functions</a></h2>
<ul>
<li><code>fork()</code></li>
<li><code>exec()</code></li>
<li><code>wait()</code></li>
<li><code>abort()</code></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="threads"><a class="header" href="#threads">Threads</a></h1>
<p>A thread is the basic unit of CPU utilization. Thread creation is lightweight
compared to process creation. Threads have their Parents’ PCB, its own Thread
Control Block, register set, Stack and common Address space</p>
<p>Threads contain:</p>
<ul>
<li>ID</li>
<li>Program Counter</li>
<li>Register Set</li>
<li>Stack</li>
</ul>
<h1 id="multicore-programming"><a class="header" href="#multicore-programming">Multicore Programming</a></h1>
<p>Parallelism, concurrency. Tasks for developers include:</p>
<ul>
<li>Identifying parallelizable/concurrent tasks.</li>
<li>Balancing parallelism/concurrency.</li>
<li>Data splitting.</li>
<li>Data dependencies.</li>
<li>Testing, debugging.</li>
</ul>
<h1 id="threads-1"><a class="header" href="#threads-1">Threads</a></h1>
<p>User level thread libraries and kernel level threads exist.
We use <code>pthread</code> in this course.</p>
<p>pthreads can be implemented at the user level or kernel level.
pthreads is primarily a standard. OS's may implement this standard.</p>
<ul>
<li><code>#include &lt;pthread.h&gt;</code></li>
<li><code>pthread_create()</code></li>
<li><code>pthread_join()</code></li>
<li><code>pthread_self()</code></li>
</ul>
<hr />
<h1 id="producer-consumer-pattern"><a class="header" href="#producer-consumer-pattern">Producer, Consumer Pattern</a></h1>
<p>self explanatory.</p>
<h2 id="problems"><a class="header" href="#problems">Problems</a></h2>
<p>Producer may produce more than the buffer can hold. (possible buffer overflow).
Consumer may attempt to retrieve data after the buffer is emptied. This is
known as the "Bounded Buffer Problem".</p>
<p>The solution: ensure both the consumer + producer know the capacity and current
size of the buffer. The producer will wait to produce if needed, the consumer
will wait to retrieve if the buffer is empty.</p>
<h2 id="race-conditions"><a class="header" href="#race-conditions">Race Conditions</a></h2>
<p>Non-deterministic order of execution of concurrent/parallel code with shared
mutable state.</p>
<p>Or</p>
<p>Race Conditions ocurr when two or more threads/processes can access shared data
and attempt to access and change that data at the same time. The currently
active thread/process can change at any time in between executions of
individual instructions potentially causing the threads/processes to access the
shared data in an arbitrary order. The typical solution is to place a lock
around the shared data.</p>
<h2 id="critical-sections"><a class="header" href="#critical-sections">Critical Sections</a></h2>
<p>Sections of code where shared mutable data is either read or written to.</p>
<p>Can be broken down into the following subsections:</p>
<ul>
<li>entry - The thread/process checks if it is okay to enter its critical section.</li>
<li>critical - The dangerous area.</li>
<li>exit</li>
<li>remainder</li>
</ul>
<p>The entry and critical sections are the most important.</p>
<h2 id="supporting-critical-sections"><a class="header" href="#supporting-critical-sections">Supporting Critical Sections</a></h2>
<h3 id="mutual-exclusions"><a class="header" href="#mutual-exclusions">Mutual Exclusions</a></h3>
<p>Only one process should execute code in their critical section at a time.</p>
<h4 id="mutexes"><a class="header" href="#mutexes">Mutexes</a></h4>
<p>Mutexes facilitate this: first <code>acquire()</code> a lock, later <code>release()</code> the lock.
These two functions need to be atomic and may require hardware support. Trying
to acquire an already acquired lock will cause "busy" waiting. this kind of
behaviour is also called a <em>spinlock</em>.</p>
<h3 id="progress-guaranteed"><a class="header" href="#progress-guaranteed">Progress Guaranteed</a></h3>
<p>If no process is in its critical section, and a process wants to enter its
critical section, <em>selection</em> of the next process to enter its critical section
cannot be postponed indefinitely.</p>
<h3 id="bounded-waiting"><a class="header" href="#bounded-waiting">Bounded Waiting</a></h3>
<p>There is a bound on the number of process's that can cut in line when multiple
are waiting to enter their critical sections.</p>
<h3 id="semaphores"><a class="header" href="#semaphores">Semaphores</a></h3>
<p>Binary Semaphore - Same as Mutex.
Counting Semaphore - internal counter can range over an unrestricted domain.
Use atomic 'wait' and 'signal' functions.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="cpu-scheduling"><a class="header" href="#cpu-scheduling">CPU Scheduling</a></h1>
<h2 id="the-cpu-io-burst-cycle"><a class="header" href="#the-cpu-io-burst-cycle">The CPU-I/O Burst Cycle</a></h2>
<p>During a CPU burst, the CPU performs computations that don't rely on I/O. Each
CPU burst can be of arbitrary length, but is usually followed by an I/O burst.
I/O bursts are sections of time where the CPU waits for I/O (Though, the CPU
<em>could</em> swap processes at this time to keep itself busy.) Our concern is to
distribute CPU bursts efficiently.</p>
<h2 id="cpu-scheduler"><a class="header" href="#cpu-scheduler">CPU Scheduler</a></h2>
<p>Selects processes among those in the ready queue, and allocates them CPU time.
Scheduling decisions may take place when a process:</p>
<ol>
<li>Switches from running to waiting state</li>
<li>Switches from running to ready state</li>
<li>Switches from waiting to ready</li>
<li>Terminates</li>
</ol>
<h2 id="criteria--good-things"><a class="header" href="#criteria--good-things">Criteria &amp; Good Things</a></h2>
<p><strong>CPU utilization</strong> – We want to max this. Keep the CPU as busy as possible.<br />
<strong>Throughput</strong> – We want to max this. # of processes that complete their
execution per time unit.<br />
<strong>Turnaround time</strong> – We want to min this. Amount of time to execute a
particular process.<br />
<strong>Waiting time</strong> – We want to min this. Amount of time a process has been
waiting in the ready queue.<br />
<strong>Response time</strong> – We want to min this. Amount of time it takes from when a
request was submitted until the first response is produced, not output (for
time-sharing environment). wait time + response time.</p>
<h2 id="cpu-scheduling-algos"><a class="header" href="#cpu-scheduling-algos">CPU Scheduling Algos</a></h2>
<ul>
<li>First Come First Serve - Non-preemptive, processes are run until finished.</li>
<li>Shortest Job First - Needs to know CPU burst time of process.</li>
<li>Priority Scheduling - Smallest integer means highest priority. Possible
"starvation": Low priority tasks may never execute. the solution? Aging:
priority increases w/ time.</li>
<li>Round Robin - Round robin. 1/n of CPU time for n processes in chuncks of q
(usually 10-100ms.) Preemptive.</li>
<li>Multi-Level Queue Scheduling - Ready queue is partitioned into separate
queues, e.g.:
<ul>
<li>foreground</li>
<li>background<br />
Processes are permanently in a given queue. Each queue has its own scheduling
algorithm:</li>
<li>Foreground – Round Robin</li>
<li>Background – FCFS (FIFO)<br />
Plus scheduling between queues (e.g. fixed priority (foreground first, then
background), timeslice (70% fg, 30 bg))</li>
</ul>
</li>
</ul>
<h2 id="common-priority-levels-for-multi-level-queue-scheduling"><a class="header" href="#common-priority-levels-for-multi-level-queue-scheduling">common priority levels for multi-level queue scheduling</a></h2>
<ol>
<li>system</li>
<li>interactive</li>
<li>interactive editing</li>
<li>batch</li>
<li>student</li>
</ol>
<h2 id="real-time-cpu-scheduling"><a class="header" href="#real-time-cpu-scheduling">Real Time CPU Scheduling</a></h2>
<ul>
<li><strong>Soft Real-Time</strong> - No guarantee when critical real-time processes will be
scheduled and finished.</li>
<li><strong>Hard Real-Time</strong> - Task must be serviced by deadline.</li>
</ul>
<p>The following types of latencies can affect performance of real-time systems:</p>
<ul>
<li><strong>Interrupt latency</strong> – Time from arrival of interrupt to start of routine
that services the interrupt.</li>
<li><strong>Dispatch latency</strong> – Time for the scheduler to take the current process off
the CPU and switch to another.</li>
</ul>
<h2 id="earliest-deadline-first-scheduling"><a class="header" href="#earliest-deadline-first-scheduling">Earliest Deadline First Scheduling</a></h2>
<p>A real-time scheduling algorithm. Priorities are assigned according to
deadlines: The earlier the deadline, the higher the priority; the later the
deadline, the lower the priority.</p>
<h1 id="deadlocks"><a class="header" href="#deadlocks">Deadlocks</a></h1>
<p>Cyclic waiting on resources used by processes.</p>
<p>Four conditions are required for Deadlocks to occur:</p>
<ul>
<li><strong>Mutual Exclusion</strong> of resources.</li>
<li><strong>Hold and Wait</strong> - A process w/ a resource waits for another resource held
by some other process.</li>
<li><strong>No Preemption</strong> - Resources can only be released voluntarily after a
process has completed its task.</li>
<li><strong>Circular Wait</strong> - see first sentence of this section.</li>
</ul>
<pre class="mermaid">---
title: Deadlocks
---
flowchart TB
  A((P_A)) --&gt; R1
  R1 --&gt; B((P_B))
  B --&gt; R2
  R2 --&gt; A
</pre>
<h2 id="handling-deadlocks"><a class="header" href="#handling-deadlocks">Handling Deadlocks</a></h2>
<p>We look at three different ways to handle deadlocks:</p>
<ul>
<li>Ensure the system never enters a deadlock state.
<ul>
<li>Through deadlock prevention.</li>
<li>Through deadlock avoidance.</li>
</ul>
</li>
<li>Allow the system to enter a deadlock state, then recover.</li>
<li>Ignore the problem; protend it doesn't exist.</li>
</ul>
<h3 id="deadlock-prevention"><a class="header" href="#deadlock-prevention">Deadlock Prevention</a></h3>
<p>To manage:</p>
<ul>
<li><strong>Mutal Exclusion</strong> - It is only necessary for non-safely sharable resources.</li>
<li><strong>Hold and Wait</strong> - Guarantee that whenever a process requests a resource, it
does not hold any other resource (or have all resources allocated to it prior
to execution.) This has the potential to cause low resource utilization.</li>
<li><strong>No Preemption</strong> - If a process requests a resource while it holds another,
release <em>all</em> resources that process holds.</li>
<li><strong>Circular Wait</strong> - Impose total ordering, blah, blah, yada, yada.</li>
</ul>
<h3 id="deadlock-avoidance"><a class="header" href="#deadlock-avoidance">Deadlock Avoidance</a></h3>
<p>Smart(er) allocation of resources to processes to avoid deadlocks.</p>
<ul>
<li>Processes are in a <strong>safe state</strong> if it is possible for them to complete
using the available resources.</li>
<li>Processes are in an <strong>unsafe state</strong> if it is not possible for them to
complete using the available resources.</li>
</ul>
<p>Consider the following process/resource matrix:</p>
<div class="table-wrapper"><table><thead><tr><th style="text-align: right">Process</th><th style="text-align: center">X Resource Held</th><th style="text-align: center">X Resource Required</th><th style="text-align: center">Y Resource Held</th><th style="text-align: center">Y Resource Required</th></tr></thead><tbody>
<tr><td style="text-align: right">A</td><td style="text-align: center">1</td><td style="text-align: center">8</td><td style="text-align: center">2</td><td style="text-align: center">9</td></tr>
<tr><td style="text-align: right">B</td><td style="text-align: center">2</td><td style="text-align: center">6</td><td style="text-align: center">3</td><td style="text-align: center">9</td></tr>
<tr><td style="text-align: right">C</td><td style="text-align: center">2</td><td style="text-align: center">6</td><td style="text-align: center">2</td><td style="text-align: center">3</td></tr>
</tbody></table>
</div>
<p>Available X Resources: 4<br />
Available Y Resources: 4</p>
<p>Is the system above, as a whole, in a safe state? Answer: Yes, the "safe state
sequence" is C -&gt; B -&gt; A.</p>
<h3 id="deadlock-recovery"><a class="header" href="#deadlock-recovery">Deadlock Recovery</a></h3>
<p>Deadlocks are allowed to happen. Apropriate actions are taken to recover from
the deadlock state. Given a graph of processes and the resources they
hold/request, if the graph contains a cycle, we have a deadlock. We talk about
three ways of recovering from deadlocks:</p>
<ul>
<li><strong>Preemption</strong> - Preemptive resources (resources that can be taken away) are
given to a process that requests them from a process that currently holds
them.</li>
<li><strong>Rollback</strong> - Each process is check-pointed. The state of both processes and
resources are saved. When a deadlock ocurrs, recover to a previous checkpoint.</li>
<li><strong>Killing (Processes)</strong> - Processes holding contested resources will be killed
so other processes can use those resources.</li>
</ul>
<h3 id="deadlock-ignorance"><a class="header" href="#deadlock-ignorance">Deadlock Ignorance</a></h3>
<p>Simply ignore the possibility of deadlocks. In systems where deadlocks are
rare, this is a valid strategy.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="week-5"><a class="header" href="#week-5">Week 5</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="week-6"><a class="header" href="#week-6">Week 6</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="networking---models"><a class="header" href="#networking---models">Networking - Models</a></h1>
<p>The OSI Reference Model (for fun!):</p>
<pre class="mermaid">---
title: OSI
---
flowchart TB
  A[Application Layer] --&gt; B
  B[Presentation Layer] --&gt; C
  C[Session Layer] --&gt; D
  D[Transport Layer] --&gt; E
  E[Network Layer] --&gt; F
  F[Data Link Layer] --&gt; G[Physical Layer]
</pre>
<h2 id="signals"><a class="header" href="#signals">Signals</a></h2>
<p>Different modulation schemes are used to encode data over signals. Signals can
be multiplexed to share it among multiple users. There are two types of signals
used in networks:</p>
<ul>
<li>Digital</li>
<li>Analog</li>
</ul>
<h2 id="digital-signals"><a class="header" href="#digital-signals">Digital Signals</a></h2>
<ul>
<li>Discrete values</li>
<li>Consist of "On/Off" or 1/0.</li>
</ul>
<p>We look at two different encoding techniques:</p>
<ul>
<li><strong>Current State Encoding</strong>.</li>
<li><strong>State-Transition Encoding</strong>.</li>
</ul>
<h2 id="current-state-encoding"><a class="header" href="#current-state-encoding">Current State Encoding</a></h2>
<p>Data is encoded by the presence or absence of a signal. 3 types:</p>
<ul>
<li><strong>Unipolar</strong>.</li>
<li><strong>Polar</strong>.</li>
<li><strong>Return to zero</strong>.</li>
</ul>
<h3 id="unipolar"><a class="header" href="#unipolar">Unipolar</a></h3>
<p>One polarity (positive or negative) is used. The middle zero state represents
a binary 0 while the positive/negative polarity represents a binary 1 (or
vice-versa).</p>
<p><img src="assets/signals-unipolar.png" alt="Unipolar signal diagram" /></p>
<h3 id="polar"><a class="header" href="#polar">Polar</a></h3>
<p>Similar to unipolar except both poles are used. Either positive or negative can
represent binary 1 (or 0.)</p>
<p><img src="assets/signals-polar.png" alt="Polar signal diagram" /></p>
<h3 id="return-to-zero"><a class="header" href="#return-to-zero">Return to Zero</a></h3>
<p>After the transmition of each <em>bit</em>, the voltage returns to 0. The zero state
is considered a rest state.</p>
<p><img src="assets/signals-rt0.png" alt="Return to Zero diagram" /></p>
<h2 id="state-transition-encoding"><a class="header" href="#state-transition-encoding">State-Transition Encoding</a></h2>
<p>Data is encoded by the <em>transition</em> of a high voltage to a low voltage (or
vice-versa.) The transition is observed <em>mid bit</em>.</p>
<h3 id="manchester"><a class="header" href="#manchester">Manchester</a></h3>
<p>Transition form high to low is 1, low to high 0 (or vice-versa.)</p>
<p><img src="assets/signals-manchester.png" alt="Manchester diagram" /></p>
<h2 id="analog-signals"><a class="header" href="#analog-signals">Analog Signals</a></h2>
<p>Electro-magnetic waves! Sine waves! There are two types of modulation
techniques we look at:</p>
<ul>
<li><strong>Amplitude Modulation</strong> - The amplitude of the wave encodes the bit value.
For example: Higher amplitudes encode a 1, while lower amplitudes encode a 0.</li>
<li><strong>Frequency Modulation</strong> - The frequency of the wave encodes the bit value.
For example: Higher frequencies encode a 1, while lower frequencies encode a
0.</li>
</ul>
<h2 id="the-data-link-layer"><a class="header" href="#the-data-link-layer">The Data Link Layer</a></h2>
<p>This is where bits are framed into packets and hardware level addressing (e.g.
MAC addresses) ocurrs. And, importantly, Error detection and correction.</p>
<h2 id="parity-checks"><a class="header" href="#parity-checks">Parity Checks</a></h2>
<ul>
<li>Considered the simplest form of error detection.</li>
<li>Two types:
<ul>
<li>Even parity.</li>
<li>Odd parity.</li>
</ul>
</li>
</ul>
<h3 id="even-parity"><a class="header" href="#even-parity">Even Parity</a></h3>
<p>The number of on bits in a chunk of data is checked. If odd, the additional
parity bit at the end of the data is set to 1. If even, the additional parity
bit is set to 0.</p>
<h3 id="odd-parity"><a class="header" href="#odd-parity">Odd Parity</a></h3>
<p>The opposite of even parity. We check the number of on bits and set the parity
bit so that the number of 1s is odd.</p>
<h2 id="checksums"><a class="header" href="#checksums">Checksums</a></h2>
<p>Changing an even amount of bits in the data can fool our parity checks. The
simple checksum is an improvement over flimsy parity checks:</p>
<ol>
<li>Consider all the "words" in the chunk of data to checksum.</li>
<li>Sum them all up.</li>
<li>Take the 1's complement (binary NOT).</li>
<li>Send the original data along with the 1's complement of the sum.</li>
<li>On the receiver side, take the sum of the words in the received data. Add
the checksum (the 1's complement sent by the sender) and check that the
result contains all bits set to 1.</li>
</ol>
<h2 id="the-tcp-model-exists"><a class="header" href="#the-tcp-model-exists">The TCP Model Exists!</a></h2>
<h2 id="ip-addresses"><a class="header" href="#ip-addresses">IP Addresses</a></h2>
<p>IP Addresses are allocated in blocks called "prefixes". The prefix refers to
the network portion of an IP address. It is followed by the host portion.
You'll occasionally see IPv4 address written in the 192.168.0.1/24 notation.
The <code>/24</code> part specifies how large the network portion is in terms of bits. The
corresponding subnet mask has the same number of 1 bits.</p>
<h3 id="classful-addressing"><a class="header" href="#classful-addressing">Classful Addressing</a></h3>
<p>Older addresses came in blocks of fixed size:</p>
<ul>
<li>Class A - For regular use.</li>
<li>Class B - For regular use.</li>
<li>Class C - For regular use.</li>
<li>Class D - For <strong>multicast</strong>.</li>
<li>Class E - Reserved.</li>
</ul>
<p>The class of an IP Address can be determined from the number of consecutive 1
bits at the beginning of the address:</p>
<ul>
<li>0 consecutive 1s: class A.</li>
<li>1 consecutive 1s: class B.</li>
<li>2 consecutive 1s: class C.</li>
<li>3 consecutive 1s: class D.</li>
<li>4 consecutive 1s: class E.</li>
</ul>
<h2 id="ipv4-header"><a class="header" href="#ipv4-header">IPv4 Header</a></h2>
<p><img src="assets/ipv4-header.png" alt="IPv4 header diagram" /></p>
<h2 id="ipv6-header"><a class="header" href="#ipv6-header">IPv6 Header</a></h2>
<p><img src="assets/ipv6-header.png" alt="IPv6 header diagram" /></p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="security"><a class="header" href="#security">Security</a></h1>
<h2 id="encryption"><a class="header" href="#encryption">Encryption</a></h2>
<ul>
<li>A method of encoding data so that only authorized parties can access it.</li>
<li>Does not prevent interception or interference.</li>
<li>Encryption algorithms are called <strong>ciphers</strong>.</li>
<li>Unencrypted data is called <strong>plaintext</strong>.</li>
<li>Encrypted data is called <strong>ciphertext</strong>.</li>
<li>A cipher takes plaintext and produces ciphertext.</li>
<li>The act of encoding plaintext with a cipher is called <strong>encryption</strong>.</li>
<li>Decoding ciphertext into plaintext is called <strong>decryption</strong>.</li>
<li>Used to send sensitive data over an insecure channel.</li>
</ul>
<h2 id="key-based-encryption"><a class="header" href="#key-based-encryption">Key Based Encryption</a></h2>
<p><strong>Keys</strong> are relatively short, pseudo-random data sequences. They are used to
both encrypt and decrypt data. There are two broad types of key based
encryption algorithms: <strong>Symmetric</strong> and <strong>Asymmetric</strong>.</p>
<h2 id="symmetric-ciphers"><a class="header" href="#symmetric-ciphers">Symmetric Ciphers</a></h2>
<p>A secret key is used by ciphers to produce the encrypted data, which can then
be sent over an insecure channel. The receiver uses the same secret key to
decrypt the ciphertext. But, how do we securely share the key between two or
more people? If a third party intercepts the key exchange, they can easily pose
as the sender since they now have the secret key.</p>
<h2 id="asymmetric-ciphers"><a class="header" href="#asymmetric-ciphers">Asymmetric Ciphers</a></h2>
<p>A.K.A. <strong>Public-Key Encryption</strong>, tries to solve the key exchange issue by
creating two mathematically related keys. One is the <strong>public key</strong>, which can
be openly distributed and is used to encrypt messages to the receiver. The
other is the <strong>private key</strong>, which only the receiver knows. It is used to
decrypt the encrypted message. This allows anyone with the public key to send
encrypted messages to the receiver, but <em>only</em> the receiver can decrypt the
message. The private and public key pair are generated at the same time, but
it is not possible to derive one from the other.</p>
<h2 id="tls"><a class="header" href="#tls">TLS</a></h2>
<pre class="mermaid">sequenceDiagram
  participant C as Client
  participant S as Server
  C-&gt;&gt;S: 1. Client Hello
  S-&gt;&gt;C: 2. Server Hello
  S-&gt;&gt;C: 3. Client Certificate Request
  C-&gt;&gt;S: 4. Client Certificate
  C-&gt;&gt;S: 5. Client Sends Key Info (Encrypted with server's public key)
  C-&gt;&gt;S: 6. Certificate Verify
  C-&gt;&gt;S: 7. Finished Message
  S-&gt;&gt;C: 8. Finished Message
</pre>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->


                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">

            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="elasticlunr.min.js"></script>
        <script src="mark.min.js"></script>
        <script src="searcher.js"></script>

        <script src="clipboard.min.js"></script>
        <script src="highlight.js"></script>
        <script src="book.js"></script>

        <!-- Custom JS scripts -->
        <script src="mermaid.min.js"></script>
        <script src="mermaid-init.js"></script>

        <script>
        window.addEventListener('load', function() {
            window.setTimeout(window.print, 100);
        });
        </script>

    </div>
    </body>
</html>
